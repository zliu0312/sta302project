---
title: "dataplots"
output: html_document
date: "2025-05-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
df <- read_csv("AirBnB.csv")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r df cleaning}
library(dplyr)

df <- read_csv("AirBnB.csv")
df <- df %>% 
  select(
    -host_id,
    -host_name,
    -host_since_year,
    -host_since_anniversary,
    -matches("Customer Since"),
    -zipcode,
    -id, 
    -city,
    -state,
    -country,
    -latitude,
    -longitude,
    -matches("customers...50..review.rate"),
    -matches("X.Daily.Rev.per.2.guests..unless.limited.to.1."),
    -number_of_reviews
    )

df <- df %>%
  rename(
    age_of_exp = "Age in years",
    total_revenue = "Total Rev",
    rev_per_2_guest = "Daily Rev per 2 guests, unless limited to 1",
    min_cost_per_night = "Min Nights",
    neighbourhood = neighbourhood_cleansed,
    city = city_translated,
    state = state_translated,
  )



df$total_revenue <- as.character(df$total_revenue)
df$total_revenue_clean <- gsub("[$,]", "", df$total_revenue)
df <- df[!is.na(suppressWarnings(as.numeric(df$total_revenue_clean))), ]
df$total_revenue_clean <- as.numeric(df$total_revenue_clean)
df$total_revenue <- NULL
df$log_total_revenue <- log(df$total_revenue_clean + 1)

df$rev_per_2_guest <- as.character(df$rev_per_2_guest)
df$rev_per_2_guest_clean <- gsub("[$,]", "", df$rev_per_2_guest)
df <- df[!is.na(suppressWarnings(as.numeric(df$rev_per_2_guest_clean))), ]
df$rev_per_2_guest_clean <- as.numeric(df$rev_per_2_guest_clean)
df$rev_per_2_guest <- NULL

df$host_response_rate <- as.character(df$host_response_rate)
df$host_response_rate  <- gsub("[$,]", "", df$host_response_rate)
df <- df[!is.na(suppressWarnings(as.numeric(df$host_response_rate))), ]
df$host_response_rate <- as.numeric(df$host_response_rate)

df$price <- as.character(df$price)
df$price <- as.numeric(gsub("[$[:space:]]", "", df$price))
df <- df[!is.na(suppressWarnings(as.numeric(df$price))), ]
df$price <- as.numeric(df$price)
df$minimum_nights <- as.numeric(gsub("[$[:space:]]", "", df$minimum_nights))
View(df)
```

## Including Plots

You can also embed plots, for example:

```{r revenue plot numeric 1, echo=FALSE}
pairs(~ total_revenue_clean + age_of_exp + price + review_scores_value, data = df, 
      main = "Scatterplot Matrix of AirBnB Variables", cex = 0.01)
```
```{r log_revenue plot numeric 1, echo=FALSE}
pairs(~ log_total_revenue + age_of_exp + price + review_scores_value, data = df, 
      main = "Scatterplot Matrix of AirBnB Variables", cex = 0.01)
```

```{r revenue plot numeric 2}
pairs(~ total_revenue_clean + review_scores_rating + accommodates + host_response_rate, data = df, 
      main = "Scatterplot Matrix of AirBnB Variables", cex = 0.01)
```
```{r log_revenue plot numeric 2}
pairs(~ log_total_revenue + review_scores_rating + accommodates + host_response_rate, data = df, 
      main = "Scatterplot Matrix of AirBnB Variables", cex = 0.01)
```

```{r revenue prelim lm fit 1, echo=FALSE}
prelim_model <- lm(total_revenue_clean ~ age_of_exp + price + review_scores_value + review_scores_rating + accommodates, data = df)
summary(prelim_model)
```
```{r revenue log lm fit 1, echo=FALSE}
log_model <- lm(log_total_revenue ~ age_of_exp + price + review_scores_value + accommodates, data = df)
summary(log_model)
```

```{r revenue plot residual vs fitted, echo=FALSE}
plot(prelim_model, which = 1, cex = 0.01)
```
```{r revenue plot Q-Q plot, echo=FALSE}
plot(prelim_model, which = 2, cex=0.7)
```

```{r log_revenue plot residual vs fitted, echo=FALSE}
plot(log_model, which = 1, cex = 0.01)
```
```{r log_revenue plot Q-Q plot, echo=FALSE}
plot(log_model, which = 2, cex=0.7)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
